import{S as h}from"./sweetalert2.all-0L7EvcLS.js";import{c as b}from"./cartStore-v6FvFEc3.js";import{_ as U,m as g,a as I,g as m,o as r,c,h as a,i as v,b as e,F as y,r as j,n as u,t as i,e as w,w as V,f as x,d as k}from"./index-COv797LT.js";var A={VITE_API_URL:"https://vue3-course-api.hexschool.io/v2",VITE_API_PATH:"iris831206",BASE_URL:"/vue-sample-week6/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:C,VITE_API_PATH:L}=A,B={data(){return{form:{user:{name:"",email:"",tel:"",address:""},message:""},isLoading:!1,coupon_code:""}},methods:{...g(b,["addToCart"]),...g(b,["getCart"]),createOrder(){this.isLoading=!0;const o=`${C}/api/${L}/order`,t=this.form;this.$http.post(o,{data:t}).then(d=>{this.$router.push(`checkout/${d.data.orderId}`),this.$refs.form.resetForm(),this.getCart(),this.isLoading=!1}).catch(d=>{this.isLoading=!1,h.fire({icon:"error",title:d.response.data.message,showConfirmButton:!1,timer:1500})})},addCouponCode(){const o=`${C}/api/${L}/coupon`,t={code:this.coupon_code};this.isLoading=!0,this.$http.post(o,{data:t}).then(d=>{h.fire({icon:"success",title:d.data.message,showConfirmButton:!1,timer:1500}),this.getCart(),this.isLoading=!1}).catch(d=>{this.isLoading=!1,h.fire({icon:"error",title:d.response.data.message,showConfirmButton:!1,timer:1500})})}},computed:{...I(b,["carts","total","final_total"])},mounted(){this.getCart()}},F=e("div",{class:"loadingio-spinner-ellipsis-tyhni0y6d0m"},[e("div",{class:"ldio-vxrwqxfvut"},[e("div"),e("div"),e("div"),e("div"),e("div")])],-1),P={class:"bg-light pt-5 pb-7"},R={class:"container"},q={class:"row justify-content-center flex-md-row flex-column-reverse"},N={class:"col-md-6"},D=e("div",{class:"position-relative m-4"},[e("div",{class:"progress",style:{height:"1px"}},[e("div",{class:"progress-bar",role:"progressbar",style:{width:"50%"},"aria-valuenow":"50","aria-valuemin":"0","aria-valuemax":"100"})]),e("button",{type:"button",class:"position-absolute top-0 start-0 translate-middle btn btn-sm btn-primary rounded-pill",style:{width:"2rem",height:"2rem"}},"1"),e("button",{type:"button",class:"position-absolute top-0 start-50 translate-middle btn btn-sm btn-primary rounded-pill",style:{width:"2rem",height:"2rem"}},"2"),e("button",{type:"button",class:"position-absolute top-0 start-100 translate-middle btn btn-sm btn-secondary rounded-pill",style:{width:"2rem",height:"2rem"}},"3")],-1),M={class:"bg-white p-4"},O=e("h4",{class:"fw-bold mb-2"},"填寫收件資訊",-1),H={class:"my-5 row justify-content-center"},z={class:"mb-3"},G=e("label",{for:"email",class:"form-label"},"Email",-1),J={class:"mb-3"},K=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),Q={class:"mb-3"},W=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),X={class:"mb-3"},Y=e("label",{for:"address",class:"form-label"},"收件人地址",-1),Z={class:"mb-3"},$=e("label",{for:"message",class:"form-label"},"留言",-1),ee=e("div",{class:"text-end"},[e("button",{type:"submit",class:"btn btn-dark py-3 px-7 rounded-0"},"送出訂單")],-1),se={class:"d-flex flex-column-reverse flex-md-row mt-4 justify-content-between align-items-md-center align-items-end"},te=e("i",{class:"fas fa-chevron-left me-2"},null,-1),oe={class:"col-md-4"},le={class:"border p-4 mb-4"},ae=e("h4",{class:"mb-4"},"訂單明細",-1),ne=["src","alt"],ie={class:"w-100"},de={class:"d-flex justify-content-between fw-bold"},re={class:"mb-0"},ce={class:"mb-0"},me={class:"d-flex justify-content-between"},ue={class:"text-muted mb-0"},pe={key:0},_e={class:"text-success fs-5"},fe={key:1,class:"mb-0"},he={key:1,class:"d-flex mt-3"},be=e("p",{class:"mb-0"},"目前沒有品項",-1),ve=[be],ge=e("table",{class:"table mt-4 border-top border-bottom text-muted"},[e("tbody",null,[e("tr",null,[e("th",{scope:"row",class:"border-0 px-0 pt-4 font-weight-normal text-end"},"總計")])])],-1),ye={class:"d-flex justify-content-between mt-4"},we=e("p",{class:"mb-0 h4 fw-bold"},"Total",-1),Ve={key:2,class:"d-flex justify-content-between mt-4"},xe=e("p",{class:"mb-0 h4 fw-bold"},null,-1),ke={class:"mb-0 h4 fw-bold text-success"},Ce={key:0,class:"input-group mb-3 input-group-sm"},Le={class:"input-group-append"};function Ee(o,t,d,Te,l,f){const E=m("VueLoading"),p=m("VeeField"),_=m("ErrorMessage"),T=m("VeeForm"),S=m("RouterLink");return r(),c(y,null,[a(E,{active:l.isLoading},{default:v(()=>[F]),_:1},8,["active"]),e("div",P,[e("div",R,[e("div",q,[e("div",N,[D,e("div",M,[O,e("div",H,[a(T,{ref:"form",onSubmit:f.createOrder},{default:v(({errors:s})=>[e("div",z,[G,a(p,{id:"email",name:"email",type:"email",class:u(["form-control",{"is-invalid":s.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:l.form.user.email,"onUpdate:modelValue":t[0]||(t[0]=n=>l.form.user.email=n)},null,8,["class","modelValue"]),a(_,{name:"email",class:"invalid-feedback"})]),e("div",J,[K,a(p,{id:"name",name:"姓名",type:"text",class:u(["form-control",{"is-invalid":s.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:l.form.user.name,"onUpdate:modelValue":t[1]||(t[1]=n=>l.form.user.name=n)},null,8,["class","modelValue"]),a(_,{name:"姓名",class:"invalid-feedback"})]),e("div",Q,[W,a(p,{id:"tel",name:"電話",type:"tel",class:u(["form-control",{"is-invalid":s.電話}]),placeholder:"請輸入電話",rules:"required|min:8|max:10",modelValue:l.form.user.tel,"onUpdate:modelValue":t[2]||(t[2]=n=>l.form.user.tel=n)},null,8,["class","modelValue"]),a(_,{name:"電話",class:"invalid-feedback"})]),e("div",X,[Y,a(p,{id:"address",name:"地址",type:"text",class:u(["form-control",{"is-invalid":s.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:l.form.user.address,"onUpdate:modelValue":t[3]||(t[3]=n=>l.form.user.address=n)},null,8,["class","modelValue"]),a(_,{name:"地址",class:"invalid-feedback"})]),e("div",Z,[$,V(e("textarea",{name:"",id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":t[4]||(t[4]=n=>l.form.message=n)},null,512),[[x,l.form.message]])]),ee]),_:1},8,["onSubmit"])])]),e("div",se,[a(S,{to:"/products",class:"text-dark mt-md-0 mt-3 text-decoration-none"},{default:v(()=>[te,k("繼續購物 ")]),_:1})])]),e("div",oe,[e("div",le,[ae,o.carts&&o.carts.length>0?(r(!0),c(y,{key:0},j(o.carts,s=>(r(),c("div",{class:"d-flex mt-3",key:s.id},[e("img",{src:s.product.imageUrl,alt:s.product.title,class:"me-2",style:{width:"48px",height:"48px","object-fit":"cover"}},null,8,ne),e("div",ie,[e("div",de,[e("p",re,i(s.product.title),1),e("p",ce,"x"+i(s.qty),1)]),e("div",me,[e("p",ue,[e("small",null,"NT$"+i(s.product.price)+"/"+i(s.product.unit),1)]),o.final_total!==o.total?(r(),c("span",pe,[e("del",null,"原價"+i(s.total),1),k(" 折扣價"),e("span",_e,i(s.final_total)+"元",1)])):(r(),c("p",fe,"小計 "+i(s.total),1))])])]))),128)):(r(),c("div",he,ve)),ge,e("div",ye,[we,e("p",{class:u(["mb-0 h4 fw-bold",{"text-decoration-line-through":o.final_total!==o.total}])},"NT $"+i(o.total)+" 元",3)]),o.final_total!==o.total?(r(),c("div",Ve,[xe,e("p",ke,"折扣價 "+i(o.final_total)+" 元",1)])):w("",!0)]),o.carts&&o.carts.length>0?(r(),c("div",Ce,[V(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[5]||(t[5]=s=>l.coupon_code=s),placeholder:"請輸入優惠碼"},null,512),[[x,l.coupon_code]]),e("div",Le,[e("button",{class:"btn btn-outline-secondary",type:"button",onClick:t[6]||(t[6]=(...s)=>f.addCouponCode&&f.addCouponCode(...s))}," 套用優惠碼 ")])])):w("",!0)])])])])],64)}const je=U(B,[["render",Ee]]);export{je as default};
