import{m as y,a as x,_ as k,o as n,c as i,b as t,F as v,r as $,d as _,t as c,e as u,w,v as I,f as R,g as L,h as f,i as C,j as V}from"./index-COv797LT.js";import{c as g}from"./cartStore-v6FvFEc3.js";import{S as d}from"./sweetalert2.all-0L7EvcLS.js";import{O as S,M as B}from"./bootstrap.esm-0DVlw3sI.js";var D={VITE_API_URL:"https://vue3-course-api.hexschool.io/v2",VITE_API_PATH:"iris831206",BASE_URL:"/vue-sample-week6/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:m,VITE_API_PATH:b}=D,F={data(){return{cartList:null,products:[],product:{},status:{loadingItem:""},cart:{},isLoading:!1,coupon_code:"",delCartModal:null}},methods:{...y(g,["getCart"]),openModal(){this.cartList.show()},openDelCartModal(){this.delCartModal.show()},goOrder(){this.$router.push("cart"),this.cartList.hide()},getProducts(){const s=`${m}/api/${b}/products`;this.isLoading=!0,this.$http.get(s).then(o=>{this.products=o.data.products,this.isLoading=!1}).catch(o=>{this.isLoading=!1,d.fire({icon:"error",title:o.response.data.message,showConfirmButton:!1,timer:1500})})},getProduct(s){this.$router.push(`product/${s}`)},...y(g,["addToCart"]),deleteAllCarts(){this.isLoading=!0;const s=`${m}/api/${b}/carts`;this.$http.delete(s).then(o=>{this.delCartModal.hide(),this.getCart(),this.isLoading=!1}).catch(o=>{this.isLoading=!1,d.fire({icon:"error",title:o.response.data.message,showConfirmButton:!1,timer:1500})})},...y(g,["getCart"]),removeCartItem(s){this.status.loadingItem=s;const o=`${m}/api/${b}/cart/${s}`;this.isLoading=!0,this.$http.delete(o).then(r=>{d.fire({icon:"success",title:r.data.message,showConfirmButton:!1,timer:1500}),this.status.loadingItem="",this.isLoading=!1,this.getCart()}).catch(r=>{this.isLoading=!1,d.fire({icon:"error",title:r.response.data.message,showConfirmButton:!1,timer:1500})})},updateCart(s){this.isLoading=!0;const o=`${m}/api/${b}/cart/${s.id}`,r={product_id:s.product_id,qty:s.qty};this.$http.put(o,{data:r}).then(h=>{d.fire({icon:"success",title:h.data.message,showConfirmButton:!1,timer:1500}),this.isLoading=!1,this.getCart()}).catch(h=>{this.isLoading=!1,d.fire({icon:"error",title:h.response.data.message,showConfirmButton:!1,timer:1500})})},addCouponCode(){const s=`${m}/api/${b}/coupon`,o={code:this.coupon_code};this.isLoading=!0,this.$http.post(s,{data:o}).then(r=>{d.fire({icon:"success",title:r.data.message,showConfirmButton:!1,timer:1500}),this.getCart(),this.isLoading=!1}).catch(r=>{this.isLoading=!1,d.fire({icon:"error",title:r.response.data.message,showConfirmButton:!1,timer:1500})})}},computed:{...x(g,["carts","total","final_total"])},mounted(){this.getCart(),this.cartList=new S(this.$refs.offcanvasRight),this.delCartModal=new B(this.$refs.delCartModal)}},A={class:"offcanvas offcanvas-end",ref:"offcanvasRight",tabindex:"-1",id:"offcanvasRight","aria-labelledby":"offcanvasRightLabel"},q=t("div",{class:"offcanvas-header"},[t("h5",{class:"offcanvas-title",id:"offcanvasRightLabel"},"購物車列表"),t("button",{type:"button",class:"btn-close text-reset","data-bs-dismiss":"offcanvas","aria-label":"Close"})],-1),E={class:"offcanvas-body"},T={class:"table-responsive"},N={class:"table table-hover align-middle text-center"},H=t("thead",null,[t("tr",null,[t("th"),t("th",null,"品名"),t("th",null,"數量"),t("th",null,"小計"),t("th")])],-1),P={style:{width:"150px"}},U=["src"],j={style:{width:"150px"}},z={key:0,class:"text-success"},O={class:"input-group input-group-sm"},J=["onUpdate:modelValue","onChange"],Q=["value"],G={class:"input-group-text"},K={style:{width:"80px"}},W={key:0,class:"text-success"},Z=["disabled","onClick"],X=t("i",{class:"bi bi-x"},null,-1),Y=[X],tt={key:1},st=t("td",{colspan:"5",class:"text-center"},"目前沒有品項",-1),et=[st],ot={class:"text-end"},at={colspan:"5"},nt={key:1},it={colspan:"5",class:"text-end text-success"},rt={key:0,class:"input-group mb-3 input-group-sm"},lt={class:"input-group-append"},dt={key:0,class:"d-grid gap-2 mx-auto"},ct={class:"modal fade",id:"delModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"delCartModal"},ut={class:"modal-dialog",role:"document"},ht={class:"modal-content border-0"},pt=t("div",{class:"modal-header bg-danger text-white"},[t("h5",{class:"modal-title"},[t("span",null,"清除購物車")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),_t=t("div",{class:"modal-body"}," 是否刪除全部品項 (刪除後將無法恢復)。 ",-1),ft={class:"modal-footer"},gt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消 ",-1);function mt(s,o,r,h,p,a){return n(),i(v,null,[t("div",A,[q,t("div",E,[t("div",T,[t("table",N,[H,t("tbody",null,[s.carts&&s.carts.length>0?(n(!0),i(v,{key:0},$(s.carts,e=>(n(),i("tr",{key:e.id},[t("td",P,[t("img",{src:e.product.imageUrl,class:"card-img-top rounded-0",style:{"object-fit":"cover"},alt:"..."},null,8,U)]),t("td",j,[_(c(e.product.title)+" ",1),e.coupon?(n(),i("div",z,"已套用優惠")):u("",!0)]),t("td",null,[t("div",O,[w(t("select",{"onUpdate:modelValue":l=>e.qty=l,onChange:l=>a.updateCart(e)},[(n(),i(v,null,$(9,l=>t("option",{key:l,value:l},c(l),9,Q)),64))],40,J),[[I,e.qty]]),t("div",G,"/ "+c(e.product.unit),1)])]),t("td",K,[e.coupon?(n(),i("small",W,"折扣價")):u("",!0),_(" "+c(e.final_total),1)]),t("td",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:p.status.loadingItem===e.id,onClick:l=>a.removeCartItem(e.id)},Y,8,Z)])]))),128)):(n(),i("tr",tt,et))]),t("tfoot",null,[s.carts&&s.carts.length>0?(n(),i("button",{key:0,type:"button",class:"btn btn-outline-danger btn-sm mt-3",onClick:o[0]||(o[0]=(...e)=>a.openDelCartModal&&a.openDelCartModal(...e))}," 清除購物車 ")):u("",!0),t("tr",ot,[t("td",at,"總計 $ "+c(s.total)+" 元",1)]),s.final_total!==s.total?(n(),i("tr",nt,[t("td",it,"折扣價 "+c(s.final_total)+" 元",1)])):u("",!0)])]),s.carts&&s.carts.length>0?(n(),i("div",rt,[w(t("input",{type:"text",class:"form-control","onUpdate:modelValue":o[1]||(o[1]=e=>p.coupon_code=e),placeholder:"請輸入優惠碼"},null,512),[[R,p.coupon_code]]),t("div",lt,[t("button",{class:"btn btn-outline-secondary",type:"button",onClick:o[2]||(o[2]=(...e)=>a.addCouponCode&&a.addCouponCode(...e))}," 套用優惠碼 ")])])):u("",!0)]),s.carts.length!==0?(n(),i("div",dt,[t("button",{class:"btn btn-primary",type:"button",onClick:o[3]||(o[3]=(...e)=>a.goOrder&&a.goOrder(...e))},"結帳")])):u("",!0)])],512),t("div",ct,[t("div",ut,[t("div",ht,[pt,_t,t("div",ft,[gt,t("button",{type:"button",class:"btn btn-danger",onClick:o[4]||(o[4]=(...e)=>a.deleteAllCarts&&a.deleteAllCarts(...e))},"確認刪除 ")])])])],512)],64)}const bt=k(F,[["render",mt]]),vt={data(){return{topIndex_show:!0,cartList:null}},methods:{...y(g,["getCart"]),openCartList(){this.$refs.offcanvasRight.openModal()}},computed:{...x(g,["carts"])},watch:{$route:function(s){this.topIndex_show=s.path!=="/products"}},components:{CartList:bt},mounted(){this.getCart()}},Ct={class:"navbar navbar-expand-lg navbar-dark bg-dark fixed-top"},yt={class:"container-fluid"},Lt=t("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNavAltMarkup","aria-controls":"navbarNavAltMarkup","aria-expanded":"false","aria-label":"Toggle navigation"},[t("span",{class:"navbar-toggler-icon"})],-1),kt={class:"collapse navbar-collapse",id:"navbarNavAltMarkup"},$t={class:"navbar-nav"},wt={class:"navbar-nav ms-auto"},xt=t("i",{class:"fas fa-shopping-cart"},null,-1),Mt={class:"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"},It=t("span",{class:"visually-hidden"},null,-1),Rt={class:"d-flex align-items-center justify-content-center",style:{"min-height":"400px","background-image":"url('https://storage.googleapis.com/vue-course-api.appspot.com/iris831206/1711164877939.jpg?GoogleAccessId=firebase-adminsdk-zzty7%40vue-course-api.iam.gserviceaccount.com&Expires=1742169600&Signature=mAHFNagHoim9ObPMIvIQVo8Cfm115RBuRHN4FqfO42HfeQoWynJHLsIq9eTyLg4cMFdSyVDaH10pl97Rp2inMtM3J9X4i0Cr%2BgKcWrnO2QH76rZwbwEfU2qgV9zS6wDdwVmXg4zFjhEmXtjusbmQrGLdvKscMz1iH76CwEkSIxnvw9jEv89ZJMlWKHots%2FkCYnqxDZa2D%2FGsLqbJRx%2FcEo5DnxMUy6%2BLlyjB6YqrzZoGiLpeICcRqFHfqXSKtqmQt7LWzJ2RQmGCVfZ61p1cJuTzNTrJFPs8ke93l1MqaV6uSSK1WUI57rDsVSh7p53ptTf%2FFcrDLULrk28ai7j5kw%3D%3D')","background-size":"cover","background-position":"center"}},Vt={class:"row justify-content-center my-auto"},St={class:"text-center"},Bt=t("h2",{class:"fw-bold"},"日安手作",-1);function Dt(s,o,r,h,p,a){const e=L("RouterLink"),l=L("CartList");return n(),i(v,null,[t("nav",Ct,[t("div",yt,[f(e,{to:"/",class:"navbar-brand"},{default:C(()=>[_("Sunlight")]),_:1}),Lt,t("div",kt,[t("div",$t,[f(e,{to:"/products",class:"nav-link"},{default:C(()=>[_("產品")]),_:1}),f(e,{to:"/cart",class:"nav-link"},{default:C(()=>[_("購物車")]),_:1})]),t("div",wt,[t("p",{class:"nav-link btn btn-primary position-relative me-5 mb-0",onClick:o[0]||(o[0]=(...M)=>a.openCartList&&a.openCartList(...M)),style:{width:"50px"}},[xt,t("span",Mt,c(s.carts.length),1),It])])])])]),t("div",Rt,[t("div",Vt,[t("div",St,[Bt,p.topIndex_show?(n(),V(e,{key:0,to:"/products",class:"btn btn-dark rounded-0 mt-2","z-index":"1060"},{default:C(()=>[_(" 選購商品 ")]),_:1})):u("",!0)])])]),f(l,{ref:"offcanvasRight"},null,512)],64)}const Ft=k(vt,[["render",Dt]]),At={components:{FrontNavbar:Ft}};function qt(s,o,r,h,p,a){const e=L("FrontNavbar"),l=L("RouterView");return n(),i(v,null,[f(e),f(l)],64)}const Pt=k(At,[["render",qt]]);export{Pt as default};
